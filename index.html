<!DOCTYPE html>
<html>
<head>
    <title>Shit And Car</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #282c34;
        }
        canvas {
            background-color: #000;
            image-rendering: pixelated;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        const carWidth = 90;
        const carHeight = 80;
        const roadWidth = 400; // Tăng kích thước đường
        const roadLeft = canvas.width / 2 - roadWidth / 2;
        const roadRight = canvas.width / 2 + roadWidth / 2;
        const obstacleWidth = 70;
        const obstacleHeight = 70;
        const car = { x: canvas.width / 2 - carWidth / 2, y: canvas.height - carHeight - 10 };
        const obstacles = [];
        let score = 0;
        let bestScore = 0;
        let speed = 2;
        let gameOver = false;

        const carImage = new Image();
        carImage.src = 'car.png'; // Đường dẫn URL đến hình ảnh xe
        
        const obstacleImage = new Image();
        obstacleImage.src = 'shit.png'; // Đường dẫn URL đến hình ảnh chướng ngại vật

        // Âm thanh
        const engineSound = new Audio('https://rr2---sn-i3b7knsd.googlevideo.com/videoplayback?expire=1731181283&ei=g2YvZ-_eIuesvcAPy5__kAg&ip=154.208.62.236&id=o-AGvsH8yr3KyQv828zAj-C3HQwGmbeJwlS-hvpccvp_MZ&itag=140&source=youtube&requiressl=yes&xpc=EgVo2aDSNQ%3D%3D&bui=AQn3pFRFISnMiOWAfEQP3HFAo_DYoVhuTPUfZoz38TDgDJLscAvFScwaetIUkinuCjwtCRiIleYBXzo7&spc=qtApAaEPksYIQnJqPMXpHyG7xC2SNRzco_yOwXInrkNdhO3gvCplorlIe2I0&vprv=1&svpuc=1&mime=audio%2Fmp4&ns=-dnm7ExJwbdgmwwYDoAnU3gQ&rqh=1&gir=yes&clen=185275&dur=11.400&lmt=1631469263167117&keepalive=yes&fexp=24350590,24350655,24350675,24350705,24350737,51312688,51326932&c=WEB&sefc=1&txp=5311224&n=-_JjbGufl0QnTA&sparams=expire%2Cei%2Cip%2Cid%2Citag%2Csource%2Crequiressl%2Cxpc%2Cbui%2Cspc%2Cvprv%2Csvpuc%2Cmime%2Cns%2Crqh%2Cgir%2Cclen%2Cdur%2Clmt&sig=AJfQdSswRQIhAKm4X3tGh1oVmOgsnVD8FNImjZIx-EXqvEoSE5P8ySEsAiBoKvzzDYHwoiUcdCc30xXo_8WrckjK1tHgKjmmaDeIHQ%3D%3D&rm=sn-poj5caxpouxgoxu-aixl7s,sn-hjud7l&rrc=79,104,80&req_id=fbe5055adff2a3ee&ipbypass=yes&redirect_counter=3&cm2rm=sn-8qj-nbo6y7e&cms_redirect=yes&cmsv=e&met=1731168859,&mh=i9&mip=14.191.232.243&mm=30&mn=sn-i3b7knsd&ms=nxu&mt=1731168514&mv=m&mvi=2&pl=24&rms=nxu,au&lsparams=ipbypass,met,mh,mip,mm,mn,ms,mv,mvi,pl,rms&lsig=AGluJ3MwRQIgXtC3W1GZV0n_0qzefoEQeIpe1RIYMtzJ7VnxKiN4NfQCIQCLFrXtWr7iRhJPWeiEsCye5MAl8sU12B2pypAz4BY0Gw%3D%3D'); // Đường dẫn URL đến âm thanh xe chạy
        //const engineSound = new Audio('z');
        engineSound.volume = 0.0;
        const crashSound = new Audio('https://rr2---sn-i3b7knlk.googlevideo.com/videoplayback?expire=1731190571&ei=y4ovZ4HfDPm76dsPqY3A0Ag&ip=31.15.186.111&id=o-ANJ7MmFV43EWihqff6iJ1enb0a--zfKoLJ6P7IULur78&itag=140&source=youtube&requiressl=yes&xpc=EgVo2aDSNQ%3D%3D&bui=AQn3pFQT3T1JrxcuzT7up9FOy4EDEGNmKV4XBQ4C_P803HJ3xFDehEPZqm8xE_C0e3r1F3Kg6CH5Nj03&vprv=1&mime=audio%2Fmp4&rqh=1&gir=yes&clen=34201&dur=2.066&lmt=1632376944667776&keepalive=yes&fexp=24350590,24350655,24350675,24350705,24350737,51312688,51326932&c=MEDIA_CONNECT_FRONTEND&txp=5311224&sparams=expire%2Cei%2Cip%2Cid%2Citag%2Csource%2Crequiressl%2Cxpc%2Cbui%2Cvprv%2Cmime%2Crqh%2Cgir%2Cclen%2Cdur%2Clmt&sig=AJfQdSswRgIhAJGVRVKp9jpvvcgXMLXlK-8beQTkbnB7EvcVommeBvMvAiEA6iq5tUalPqYWDPBLDMvUU5m0lYiclJ-iXdufVOMs_bw%3D&rm=sn-uxaxh5ji-aw0l7l,sn-c0qlk7l&rrc=79,104&req_id=6a277bfbda4ea3ee&cmsv=e&rms=rdu,au&redirect_counter=2&cms_redirect=yes&ipbypass=yes&met=1731168975,&mh=WB&mip=14.191.232.243&mm=29&mn=sn-i3b7knlk&ms=rdu&mt=1731168550&mv=m&mvi=2&pl=24&lsparams=ipbypass,met,mh,mip,mm,mn,ms,mv,mvi,pl,rms&lsig=ACJ0pHgwRQIhAJDGw9uBBQbUcIcXpdEnNKwTaQUtswfJv2wnhqQk6u-tAiBBvktDOi_So1L0ourKvkkqlPMdnU9NbIKY5wkh9rcwjA%3D%3D'); // Đường dẫn URL đến âm thanh va chạm
        crashSound.volume = 0.8;

        document.addEventListener('keydown', keyDownHandler, false);
        canvas.addEventListener('click', resetGame, false);

        function keyDownHandler(e) {
            if (e.key == "ArrowLeft" && car.x > roadLeft) {
                car.x -= 14;
                playEngineSound();
            }
            if (e.key == "ArrowRight" && car.x < roadRight - carWidth) {
                car.x += 14;
                playEngineSound();
            }
            if (e.key == "ArrowUp" && car.y > canvas.height - 400) {
                car.y -= 5;
                playEngineSound();
            }
            if (e.key == "ArrowDown" && car.y < canvas.height - carHeight - 10) {
                car.y += 5;
                playEngineSound();
            }
        }

        function playEngineSound() {
            if (engineSound.paused) {
                engineSound.loop = true;  // Bật chế độ lặp cho âm thanh xe chạy
                engineSound.play();
            }
        }

        function stopEngineSound() {
            engineSound.pause();
            engineSound.currentTime = 0;
        }

        function drawCar() {
            ctx.drawImage(carImage, car.x, car.y, carWidth, carHeight);
        }

        function drawObstacles() {
            obstacles.forEach(obstacle => {
                ctx.drawImage(obstacleImage, obstacle.x, obstacle.y, obstacleWidth, obstacleHeight);
                obstacle.y += speed;
                
                if (obstacle.y > canvas.height) {
                    score++;
                    if (score > bestScore) 
                        bestScore = score;
                    
                    obstacle.y = -obstacleHeight;
                }   

                if (
                    car.x < obstacle.x + obstacleWidth - 30 &&
                    car.x + carWidth - 30 > obstacle.x &&
                    car.y < obstacle.y + obstacleHeight &&
                    car.y + carHeight > obstacle.y
                ) {
                    stopEngineSound();
                    gameOver = true;
                    crashSound.play();
                }
            });
        }

        function drawRoad() {
            ctx.fillStyle = '#808080';
            ctx.fillRect(roadLeft, 0, roadWidth, canvas.height);
        }

        function drawTrees() {
            const treeRadius = 16;
            const treeGap = 50;
            ctx.fillStyle = '#228B22'; // Màu xanh lá cây

            for (let i = 0; i < canvas.height / treeGap; i++) {
                let y = i * treeGap + treeRadius;
                ctx.beginPath();
                ctx.arc(roadLeft - treeRadius - 10, y, treeRadius, 0, Math.PI * 2);
                ctx.fill(); // Cây bên trái
                ctx.beginPath();
                ctx.arc(roadRight + treeRadius + 10, y, treeRadius, 0, Math.PI * 2);
                ctx.fill(); // Cây bên phải
            }
        }

        function drawRoadLine() {
            const lineWidth = 20;
            const lineHeight = 40;
            const lineGap = 60;
            ctx.fillStyle = '#ffffff'; // Màu trắng
            
            for (let i = 0; i < canvas.height / lineGap; i++) {
                let y = i * lineGap;
                ctx.fillRect(roadLeft * 2, y, lineWidth, lineHeight);
            }
        }

        function drawBestScore() {
            ctx.font = '20px Arial';
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Best Score: ' + bestScore, 10, 20);
        }

        function drawScore() {
            ctx.font = '20px Arial';
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Score: ' + score, 10, 50);
        }

        function updateGame() {
            if (!gameOver) {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                drawTrees();
                drawRoad();
                drawRoadLine();
                drawCar();
                drawObstacles();
                drawScore();
                drawBestScore();
                requestAnimationFrame(updateGame);
            } else {
                stopEngineSound();
                ctx.font = '40px Arial';
                ctx.fillStyle = '#000000';
                ctx.fillText('Game Over\n', canvas.width / 2 - 100, canvas.height / 2);
                ctx.fillText(' Score: ' + score, canvas.width / 2 - 100, canvas.height / 2 + 50);
                console.log("game over");
            }
        }

        function resetGame() {
            if (gameOver) {
                car.x = canvas.width / 2 - carWidth / 2;
                car.y = canvas.height - carHeight - 10;
                obstacles.length = 0;
                score = 0;
                speed = 2;
                gameOver = false;
                stopEngineSound();
                updateGame();
                console.log("game reset");
            }
        }

        function addObstacle() {
            if (obstacles.length === 0 || obstacles[obstacles.length - 1].y > obstacleHeight * 3) {
                const obstacleX = roadLeft + Math.random() * (roadWidth - obstacleWidth);
                obstacles.push({
                    x: obstacleX,
                    y: -obstacleHeight
                });
            }
        }

        carImage.onload = () => {
            setInterval(addObstacle, 2000);
            updateGame();
        };
    </script>
</body>
</html>
